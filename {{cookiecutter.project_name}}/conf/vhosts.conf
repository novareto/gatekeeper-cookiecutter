<VirtualHost *:80>
    ServerName {{cookiecutter.login_host}}

    <Directory {{path}}>
      Order Allow,Deny
      Allow from all
      Require all granted
    </Directory>

    LogLevel warn
    WSGIScriptAlias / {{path}}/wsgi
    WSGIPassAuthorization On

    SetEnv CHAMELEON_CACHE {{path}}/cache
    RequestHeader set REMOTE_USER %{REMOTE_USER}e
</VirtualHost>


<VirtualHost *:80>
    ServerName {{cookiecutter.dashboard_host}}

    # RewriteRules
    TKTAuthPublicKey {{path}}/identity/server.pub
    <Location /> 
        AuthType mod_auth_pubtkt 
        TKTAuthLoginURL http://{{cookiecutter.loginhost}}/login
        TKTAuthTimeoutURL http://{{cookiecutter.loginhost}}/timeout
        TKTAuthUnauthURL http://{{cookiecutter.loginhost}}/unauthorized
        TKTAuthPassthruBasicAuth on
        TKTAuthPassthruBasicKey mKaqGWwAVNnthL6J
        TKTAuthDebug 3 
        require valid-user 
    </Location>

    ProxyPass / http://{{cookiecutter.loginhost}}/dashboard/
    ProxyPassReverse / http://{{cookiecutter.loginhost}}/dashboard/
</VirtualHost>